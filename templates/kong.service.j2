[Unit]
Description=Kong
Requires=network-online.target
After=network-online.target

[Service]
Restart=on-failure
LimitNOFILE={{ kong_max_files_limit }}
PIDFile={{ kong_prefix_dir }}/pids/nginx.pid
ExecStart=/usr/local/bin/kong start --conf {{ kong_conf_dir }}/kong.conf --nginx-conf {{ kong_conf_dir }}/custom-nginx.template
ExecReload=/usr/local/bin/kong reload --conf {{ kong_conf_dir }}/kong.conf --nginx-conf {{ kong_conf_dir }}/custom-nginx.template
ExecStop=/usr/local/bin/kong stop
{% if kong_database == "off" %}
Environment="KONG_DECLARATIVE_CONFIG={{ kong_conf_dir }}/kong.yml"
{% endif %}

[Install]
WantedBy=multi-user.target
